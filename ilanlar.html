<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>İlanlarımız</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .ilan-kutusu {
            border: 2px solid #007bff; 
            padding: 15px;
            margin-bottom: 25px; /* Alt boşluğu artırdık */
            border-radius: 8px;
            background-color: #f0f8ff; 
            display: flex; /* İçindeki resim ve metnin yan yana durması için */
            gap: 20px; /* Resim ile metin arasına boşluk */
        }
        .ilan-gorsel {
            flex-shrink: 0; /* Resmin küçülmesini engeller */
            width: 200px; /* Resim kutusu için sabit genişlik */
            height: 150px; /* Resim kutusu için sabit yükseklik */
            overflow: hidden; /* Taşmaları gizler */
            border-radius: 4px;
        }
        .ilan-gorsel img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Resmi kutuya sığdırmak için */
            display: block;
        }
        .ilan-icerik {
            flex-grow: 1; /* Metin kısmının kalan alanı kaplamasını sağlar */
        }
        .ilan-baslik {
            color: #333;
            font-size: 22px;
            font-weight: bold;
            margin-top: 0;
            margin-bottom: 5px;
        }
        .ilan-aciklama {
            color: #666;
            margin-bottom: 10px;
        }
        .ilan-link a {
            color: #e91e63; 
            text-decoration: none;
            font-weight: bold;
        }
        .ilan-link a:hover {
            text-decoration: underline;
        }
        #ilanlar-listesi {
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>Görselleriyle Birlikte İlanlarımız</h1>
    
    <div id="ilanlar-listesi">
        <p>İlanlar yükleniyor...</p>
    </div>

    <script>
        // * GOOGLE SHEETS LİNKİNİZ BURAYA ENTEGRE EDİLMİŞTİR *
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTClx_9DlBcYyCGUNKnmBxvt5f-zKK7PWEFEuFgg7Zk9lR2l2FOlsAoSIrheFT_9dpj1OVYPfh9aNdB/pub?output=csv'; 

        function ilanlariCek() {
            fetch(CSV_URL)
                .then(response => response.text())
                .then(data => {
                    const ilanlar = parseCSV(data); 
                    ilanlariGoster(ilanlar); 
                })
                .catch(error => {
                    document.getElementById('ilanlar-listesi').innerHTML = '<p style="color: red;">İlanlar yüklenirken bir hata oluştu. Lütfen Sheets\'e Foto_Link sütununu eklediğinizden emin olun.</p>';
                });
        }

        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim() !== '');
            if (lines.length < 2) return []; // Başlık satırı hariç veri yoksa
            
            const headers = lines[0].split(',').map(header => header.trim());
            const ilanlar = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                // Burada 4 sütun (Başlık, Açıklama, Facebook_Link, Foto_Link) bekliyoruz
                if (values.length >= 4) { 
                    const ilan = {};
                    ilan[headers[0]] = values[0].trim();
                    ilan[headers[1]] = values[1].trim();
                    ilan[headers[2]] = values[2].trim();
                    ilan[headers[3]] = values[3].trim(); // Yeni: Foto_Link
                    ilanlar.push(ilan);
                }
            }
            return ilanlar.reverse(); 
        }

        function ilanlariGoster(ilanlar) {
            const container = document.getElementById('ilanlar-listesi');
            
            // Başlık satırını atlama kontrolü
            const gecerliIlanlar = ilanlar.filter(ilan => ilan.Baslik && ilan.Baslik !== 'Baslik');

            if (gecerliIlanlar.length === 0) {
                 container.innerHTML = '<p>Henüz eklenmiş ilan bulunmamaktadır.</p>';
                return;
            }

            let htmlContent = '';
            
            gecerliIlanlar.forEach(ilan => {
                // Fotoğraf linki varsa göster, yoksa boş bırak
                const fotoHtml = ilan.Foto_Link ? 
                    <div class="ilan-gorsel"><img src="${ilan.Foto_Link}" alt="${ilan.Baslik} Fotoğrafı"></div> : 
                    '';

                // Şablonu dinamik olarak oluşturuyoruz (Görsel ve İçerik Yan Yana)
                 htmlContent += `
                    <div class="ilan-kutusu">
                        ${fotoHtml} 
                        <div class="ilan-icerik">
                            <div class="ilan-baslik">${ilan.Baslik}</div>
                            <p class="ilan-aciklama">${ilan.Aciklama}</p>
                            <div class="ilan-link">
                                <a href="${ilan.Facebook_Link}" target="_blank">Facebook İlanına Git (Tıklayın)</a>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = htmlContent;
        }

        ilanlariCek();
    </script>
</body>
</html>

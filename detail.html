<!DOCTYPE html>
<html lang="tr">
<head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QL7NLR92NW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-QL7NLR92NW');
</script>

<meta charset="UTF-8">
<title>Müşteri Detayı</title>

<style>
    body {
        font-family: Arial;
        background: #f2f2f2;
        padding: 20px;
    }
    .card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input, textarea {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
        border: 1px solid #aaa;
        border-radius: 5px;
    }
    button {
        width: 100%;
        padding: 12px;
        margin-top: 15px;
        border: none;
        border-radius: 6px;
        color: white;
        font-size: 16px;
        cursor: pointer;
    }
    .save-btn { background: #28a745; }
    .delete-btn { background: #dc3545; }
    .whatsapp-btn { background: #25d366; }
    .back-btn { background: #007bff; }
</style>

</head>
<body>

<div class="card">
    <h2>Müşteri Detayı</h2>

    <label>İsim</label>
    <input id="name">

    <label>Telefon</label>
    <input id="phone">

    <label>Not</label>
    <textarea id="note"></textarea>

    <button class="save-btn" onclick="saveChanges()">Kaydet</button>
    <button class="whatsapp-btn" onclick="sendWhatsApp()">WhatsApp Mesaj Gönder</button>
    <button class="delete-btn" onclick="deleteCustomer()">Müşteriyi Sil</button>
    <button class="back-btn" onclick="goBack()">Panele Dön</button>
</div>


<script>
let index = localStorage.getItem("selectedCustomer");
let customers = JSON.parse(localStorage.getItem("customers")) || [];

let customer = customers[index];

// Sayfaya bilgileri doldur
document.getElementById("name").value = customer.name;
document.getElementById("phone").value = customer.phone;
document.getElementById("note").value = customer.note;

// Kaydet
function saveChanges() {
    customers[index].name = document.getElementById("name").value;
    customers[index].phone = document.getElementById("phone").value;
    customers[index].note = document.getElementById("note").value;

    localStorage.setItem("customers", JSON.stringify(customers));
    alert("Değişiklikler kaydedildi!");
}

// WhatsApp
function sendWhatsApp() {
    let name = document.getElementById("name").value;
    let phone = document.getElementById("phone").value;

    let message = encodeURIComponent("Merhaba " + name + ", emlak ilanıyla ilgili dönüş yapıyorum.");
    window.open("https://wa.me/" + phone + "?text=" + message, "_blank");
}

// Silme
function deleteCustomer() {
    if (confirm("Bu müşteriyi silmek istediğinize emin misiniz?")) {
        customers.splice(index, 1);
        localStorage.setItem("customers", JSON.stringify(customers));
        alert("Müşteri silindi.");
        window.location.href = "panel.html";
    }
}

// Geri dönüş
function goBack() {
    window.location.href = "panel.html";
}
</script>

</body>
</html>